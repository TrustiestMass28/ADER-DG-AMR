import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

def main_convergence():

    #===================================#
    N = np.array([8,16,32,64,128,256])
    p = 1
    L = 2
    #===================================#

    if L==2:   
        # Single level     
        #p_E = {1:[0.048870899515791516, 0.01753439920565603,0.0087262139910766756, 0.0057269497617791539],
        #       2:[0.0087790966099986489, 0.0017085238936960308,0.00012726442764960074,1.5981709704366251e-05],
        #       3:[0.0027877884461944696,0.0001746922677643825,7.8290770603552511e-06,3.9752247868729303e-07]}

        # Multi level - Continuous Refinement
        p_E = {1:[0.014873587007379984, 0.0078633483485543391 ,0.0054486254193363264,0.0026497185763757741,0.0014682112879695437,],
                2:[0.0051160903097895467,0.0011868857611137781,0.00050491806975440324,8.4546662849201064e-05]}

        #p_E = {3:[0.0019264535418726928,0.00021549807813933615,3.0353802293709399e-05]}
        #p_E = { 3:[0.0027416991284634554,0.0002403841011706694,1.9748149276483733e-05,6.6740726974810086e-06]}
        #p_E = {3:[0.0019264535418726928,0.00021549807813933615,3.0353802293709399e-05]}
        
        
    slope, intercept, r_value, p_value, std_err = linregress(np.log10(N), np.log10(p_E[p]))
    print("EOC p"+str(p)+": "+str(abs(slope)))  
    print("TOC p"+str(p)+": "+str(p+1))  

if __name__ == "__main__":
    main_convergence()

